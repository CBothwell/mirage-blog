machine:
  ruby:
    version: 2.1.1
dependencies:
  pre:
    - gem install jekyll
    - sudo add-apt-repository -y ppa:avsm/ppa
    - sudo apt-get -y update
    - sudo apt-get -y install build-essential m4 ocaml ocaml-native-compilers camlp4-extra opam
    - OPAMYES=true
    - opam init
    - opam switch 4.01.0
    - eval `opam config env`
    - opam install mirage
    - opam install mirage-seal
  post:
    - cd blog-src && jekyll build
    - cd ../ && mirage-seal --data=htdocs --no-tls --target=xen
deployment:
    linode:
      branch: linode
      commands:
        - bash bin/linode-deploy.sh
