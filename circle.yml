machine:
  environment:
    PATH: $PATH:/home/ubuntu/.opam/4.01.0/bin
  ruby:
    version: 2.1.1
dependencies:
  pre:
    - gem install jekyll
    - sudo add-apt-repository -y ppa:avsm/ppa
    - sudo apt-get -y update
    - sudo apt-get -y install build-essential m4 ocaml ocaml-native-compilers camlp4-extra opam
    - opam init -a
    - opam switch 4.01.0
    - eval `opam config env`
    - opam install -y mirage
    - opam install -y mirage-seal
    - cd blog-src && jekyll build
    - mirage-seal --data=htdocs --no-tls --target=xen
deployment:
    linode:
      branch: linode
      commands:
        - bash bin/linode-deploy.sh
